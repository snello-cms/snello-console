<sidebar />
<div class="sidebar">
	<adminhome-topbar />
</div>

<div class="sidebar-subpage">
	<h3>View Metadata</h3>
	<p></p>
</div>

<div class="main">
	<div class="container-fluid">
		<div class="row">
			<p-tabs value="0">
				<p-tablist>
					<p-tab value="0">Metadata</p-tab>
					<p-tab value="1">Field Definitions</p-tab>
				</p-tablist>
				<p-tabpanels>
					<p-tabpanel value="0">
						<div class="content view">
							<div class="row">
								<div class="col-sm-12">
									<div class="btn-group pull-right">
										<button
											pButton
											class="btn btn-success pull-right"
											(click)="edit()"
											icon="fa fa-pencil">
											Edit
										</button>
										@if (!element.created && !element.already_exist) {
											<button
												type="button"
												class="btn btn-primary"
												(click)="confirmCreateTable()"
												title="Create Table on Database"
												icon="fa fa-table">
												Create DB Table
											</button>
										}
										@if (element.created && !element.already_exist) {
											<button
												type="button"
												class="btn btn-warning"
												(click)="confirmTruncateTable()"
												title="Truncate Table Data"
												icon="fa fa-eraser">
												Truncate DB Table Data
											</button>
											<button
												type="button"
												class="btn btn-danger"
												(click)="confirmDeleteTable()"
												title="Delete Table on Database"
												icon="fa fa-exclamation-triangle">
												Delete DB Table
											</button>
										}
									</div>
									<h3>{{ element.table_name }}</h3>
								</div>
							</div>

							<div class="clearfix"></div>
							<br /><br />
							<div class="clearfix"></div>

							<div class="row">
								<div class="col-sm-6">
									<div class="form-group clearfix row">
										<label class="label-text col-sm-4">Label (*):</label>
										<div class="col-sm-8">{{ element.table_name }}</div>
									</div>

									<div class="form-group clearfix row">
										<label class="label-text col-sm-4">Icon:</label>
										<div class="col-sm-8">
											@if (element.icon) {
												<i [class]="element.icon"></i>
											}
										</div>
									</div>

									<div class="form-group clearfix row">
										<label class="label-text col-sm-4">Select Fields:</label>
										<div class="col-sm-8">{{ element.select_fields }}</div>
									</div>

									<div class="form-group clearfix row">
										<label class="label-text col-sm-4">Search Fields:</label>
										<div class="col-sm-8">{{ element.search_fields }}</div>
									</div>

									<div class="form-group clearfix row">
										<label class="label-text col-sm-4">Description:</label>
										<div class="col-sm-8">{{ element.description }}</div>
									</div>

									<div class="form-group clearfix row">
										<label class="label-text col-sm-4">Alias table:</label>
										<div class="col-sm-8">{{ element.alias_table }}</div>
									</div>

									<div class="form-group clearfix row">
										<label class="label-text col-sm-4">Alias condition:</label>
										<div class="col-sm-8">{{ element.alias_condition }}</div>
									</div>
								</div>

								<div class="col-sm-6">
									<div class="form-group clearfix row">
										<label class="label-text col-sm-4">Table key (*):</label>
										<div class="col-sm-8">{{ element.table_key }}</div>
									</div>

									<div class="form-group clearfix row">
										<label class="label-text col-sm-4">Table key Type(*):</label>
										<div class="col-sm-8">{{ element.table_key_type }}</div>
									</div>

									@if (element.table_key_type === 'slug') {
										<div class="form-group clearfix row">
											<label class="label-text col-sm-4">Table key Addition (*):</label>
											<div class="col-sm-8">{{ element.table_key_addition }}</div>
										</div>
									}

									<div class="form-group clearfix row">
										<label class="label-text col-sm-4">Creation query:</label>
										<div class="col-sm-8">{{ element.creation_query }}</div>
									</div>

									<div class="form-group clearfix row">
										<label class="label-text col-sm-4">Tab & Groups:</label>
										<div class="col-sm-8">{{ element.tab_groups }}</div>
									</div>

									<div class="form-group clearfix row">
										<label class="label-text col-sm-4">Order By:</label>
										<div class="col-sm-8">{{ element.order_by }}</div>
									</div>

									<div class="form-group clearfix row">
										<label class="label-text col-sm-4">Created?:</label>
										<div class="col-sm-8">{{ element.created }}</div>
									</div>

									<div class="form-group clearfix row">
										<label class="label-text col-sm-4">Already exist?:</label>
										<div class="col-sm-8">{{ element.already_exist }}</div>
									</div>
								</div>
							</div>
						</div>
					</p-tabpanel>

					<p-tabpanel value="1">
						<div class="content view">
							<button
								pButton
								class="btn btn-add pull-right"
								(click)="newFieldDefinition()"
								[disabled]="element.created"
								icon="fa fa-plus-circle">
								Add New
							</button>
							<h3>Field Definitions</h3>
							<div class="clearfix"></div>
							<br />
							<div class="clearfix"></div>

							<p-table
								[paginator]="true"
								[resizableColumns]="true"
								styleClass="p-datatable-responsive"
								[rows]="10"
								[value]="fieldDefinitions">
								<ng-template pTemplate="header">
									<tr class="sort-header">
										<th pResizableColumn>Index</th>
										<th pResizableColumn>Name</th>
										<th pResizableColumn>Metadata Name</th>
										<th pResizableColumn>Label</th>
										<th pResizableColumn>Table Key</th>
										<th pResizableColumn>Input Type</th>
										<th pResizableColumn>Operations</th>
									</tr>
								</ng-template>

								<ng-template pTemplate="emptymessage">
									<tr>
										<td colspan="7">No results.</td>
									</tr>
								</ng-template>

								<ng-template pTemplate="body" let-rowData let-rowIndex="rowIndex">
									<tr>
										<td class="RowIndex">{{ rowIndex + 1 }}</td>
										<td class="ui-resizable-column">{{ rowData.name }}</td>
										<td class="ui-resizable-column">{{ rowData.metadata_name }}</td>
										<td class="ui-resizable-column">{{ rowData.label }}</td>
										<td class="ui-resizable-column">{{ rowData.table_key }}</td>
										<td class="ui-resizable-column">{{ rowData.type }}</td>
										<td class="ui-resizable-column">
											<button
												(click)="editField(rowData)"
												class="btn btn-success btn-sm"
												[disabled]="element.created"
												pButton
												icon="fa fa-pencil">
												Edit
											</button>
										</td>
									</tr>
								</ng-template>
							</p-table>
						</div>
					</p-tabpanel>
				</p-tabpanels>
			</p-tabs>
		</div>
	</div>
</div>
